<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> 所在地附近商家資訊 </title>
    <style>
    #maparea
    {
        float:left ; margin: 10px ;
        width:700px;height:600px ;
        background:black; 
    }
    
    #funlist
    {
        float:left ; margin: 6px ;
        width:180px;height:600px;
        background:gray;    
        color:White;     
    }
    div.listItem
    {
        padding : 2px  ;
        margin:4px;
        border:1px dotted white ;
        cursor:pointer;
    }
    
    </style>
    <!-- 請輸入自己申請好的金鑰，並且勿外流！ -->
    <script src="&callback=displayMap"></script>
    <script src="map-data.js" ></script>
    <script>
        function init()
        {
            var g = window.navigator.geolocation;
            g.getCurrentPosition(succ);
        }
        var mapdisplay; 
        function succ(arg)
        {
             //var l = arg.coords.latitude;
             //var y = arg.coords.longitude;

            //台北 101 
            var l = 25.034123;
            var y = 121.564504;

            var xy = new google.maps.LatLng(l, y);
            var maparea = document.querySelector("div#maparea");
            var option = {
                zoom: 14,
                center: xy,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            mapdisplay = new google.maps.Map(maparea, option);
            var marker = new google.maps.Marker({ position: xy, map: mapdisplay });
            marker.setTitle('目前位置'); 
        }
        function showInfo(o)
        {
            switch (o.id)
            {
                case 'sb':
                    getLocation(sb, '星巴克（STARBUCK）');
                    break; 
                case 'se':
                    getLocation(se, '統一超商（7-11）');
                    break ; 
                case 'family':
                    getLocation(family, '全家');
                    break ;
                case 'md':
                    getLocation(md, '麥當勞');
                    break ;
            }
        }
        var markers = new Array(); 
        function getLocation(as,title)
        {
            var i = 0;
            for (var k in markers)
            {
                markers[k].setVisible(false);
            }
            for (var k in as)
            {
                var l = as[k].split(',')[0]; 
                var y = as[k].split(',')[1]; 
                var xy = new google.maps.LatLng(l, y);
                var marker = new google.maps.Marker({ position: xy, map: mapdisplay });
                marker.setTitle(title); 
                markers[i]  = marker;i++ ;           
            }           
        }
    
    </script>

</head>

<body onload="init()">
<div id="box">
<div id="maparea"></div>
<div id="funlist">

    <div id="sb" class="listItem" onclick="showInfo(this)" > 星巴克｜STARBUCK </div>
    <div id="se" class="listItem" onclick="showInfo(this)"> 統一超商｜7-11 </div>
    <div id="family" class="listItem" onclick="showInfo(this)"> 全家｜Family </div>
    <div id="md" class="listItem" onclick="showInfo(this)"> 麥當勞｜Mcdonalds </div>

</div>
</body>
</html>